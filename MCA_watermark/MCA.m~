%%%%%%%%%%%%%%% Barbara image %%%%%%%%%%%%%%%%%%%%%%%%
clear all;clc;close all;
watermark = double(imread('changsha.bmp'));
imgc = double(imread('lena.jpg'));
vecOrig1 = watermark(:)';
vecOrig2 = imgc(:)';

dim_c1 = 512;
dim_c2 = 512;
dim_w1 = 64;
dim_w2 = 64;

% normalise original image to unity variance
vecOrig1 = normalize(vecOrig1);
vecOrig2 = normalize(vecOrig2);



watermark = reshape(vecOrig1,[dim_w1,dim_w2]);
imgc = reshape(vecOrig2,[dim_c1,dim_c2]);



% Dictionary stuff (here Curvelets + UDWT).
dict1='CURVWRAP';pars11=2;pars12=0;pars13=0;
dict2='LDCT2';pars21=256;pars22=16/256;pars23=0; % Remove Low-frequencies < 16/256 from textured part.
dicts=MakeList(dict1,dict2);
pars1=MakeList(pars11,pars21);
pars2=MakeList(pars12,pars22);
pars3=MakeList(pars13,pars23);